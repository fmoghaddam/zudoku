import { jsx as _jsx } from "react/jsx-runtime";
import { Slot } from "@radix-ui/react-slot";
import { XIcon } from "lucide-react";
import { createContext, use, useCallback, useState, } from "react";
import { useLatest } from "../util/useLatest.js";
import { Alert, AlertAction } from "./Alert.js";
import { Button } from "./Button.js";
const DismissibleAlertContext = createContext({
    dismiss: () => { },
});
const useDismissibleAlertContext = () => use(DismissibleAlertContext);
const DismissibleAlert = ({ onDismiss, ...props }) => {
    const [isDismissed, setIsDismissed] = useState(false);
    const latestOnDismiss = useLatest(onDismiss);
    const dismiss = useCallback(() => {
        setIsDismissed(true);
        latestOnDismiss.current?.();
    }, [latestOnDismiss]);
    if (isDismissed)
        return null;
    return (_jsx(DismissibleAlertContext, { value: { dismiss }, children: _jsx(Alert, { ...props }) }));
};
const DismissibleAlertCloseButton = ({ asChild, ...props }) => {
    const { dismiss } = useDismissibleAlertContext();
    const Comp = asChild ? Slot : Button;
    return _jsx(Comp, { onClick: dismiss, ...props });
};
const DismissibleAlertAction = ({ children }) => (_jsx(AlertAction, { children: _jsx(DismissibleAlertCloseButton, { variant: "ghost", size: "icon-xxs", className: "hover:text-current hover:bg-[color-mix(in_srgb,currentColor_10%,transparent)]!", children: children ?? _jsx(XIcon, { className: "size-3.5" }) }) }));
export { DismissibleAlert, DismissibleAlertCloseButton as DismissibleAlertClose, DismissibleAlertAction, };
//# sourceMappingURL=DismissibleAlert.js.map