import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { CheckIcon, CopyIcon, EyeIcon, EyeOffIcon } from "lucide-react";
import { useState } from "react";
import { cn } from "../util/cn.js";
import { useCopyToClipboard } from "../util/useCopyToClipboard.js";
import { Button } from "./Button.js";
export const SecretText = ({ secret, revealed = false, previewChars = 5, className, }) => {
    if (revealed) {
        return _jsx("span", { className: className, children: secret });
    }
    const hiddenPart = "•••• ".repeat(secret.slice(0, -previewChars).length / 5) +
        "•".repeat(secret.slice(0, -previewChars).length % 5);
    const visiblePart = previewChars > 0 ? secret.slice(-previewChars) : "";
    return (_jsx("span", { className: cn("block overflow-hidden text-ellipsis whitespace-nowrap", className), dir: "rtl", children: _jsxs("span", { dir: "ltr", className: "inline", children: [_jsx("span", { className: "opacity-50", children: hiddenPart }), visiblePart && _jsx("span", { children: visiblePart })] }) }));
};
export const Secret = ({ secret, preview = 5, className, status, onCopy, revealed: controlledRevealed, onReveal, noReveal: disabledReveal, }) => {
    const previewChars = Math.abs(preview);
    const [isRevealed, setRevealed] = useState(false);
    const [isCopied, copyToClipboard] = useCopyToClipboard();
    const revealed = controlledRevealed ?? isRevealed;
    return (_jsxs("div", { className: cn("flex gap-2 items-center text-sm border rounded-md px-1", className), children: [_jsxs("div", { className: cn("font-mono w-full h-9 items-center flex px-2 text-xs gap-2 min-w-0", revealed ? "overflow-x-auto" : "overflow-hidden"), children: [status && (_jsx("div", { className: cn("rounded-full shrink-0 w-2 h-2 mr-2", status === "active" && "bg-emerald-400", status === "expired" && "bg-neutral-200", status === "expiring" && "bg-yellow-400", status === "revoked" && "bg-red-400", status === "none" && "opacity-0") })), _jsx(SecretText, { secret: secret, revealed: revealed, previewChars: previewChars })] }), disabledReveal !== true && (_jsx(Button, { variant: "ghost", onClick: () => {
                    setRevealed((prev) => !prev);
                    onReveal?.(!revealed);
                }, size: "icon-xxs", children: revealed ? (_jsx(EyeOffIcon, { className: "size-3.5" })) : (_jsx(EyeIcon, { className: "size-3.5" })) })), _jsx(Button, { variant: "ghost", onClick: () => {
                    copyToClipboard(secret);
                    onCopy?.(secret);
                }, size: "icon-xxs", children: isCopied ? (_jsx(CheckIcon, { className: "size-3.5" })) : (_jsx(CopyIcon, { className: "size-3.5" })) })] }));
};
//# sourceMappingURL=Secret.js.map