import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { ExternalLinkIcon } from "lucide-react";
import { Badge } from "zudoku/ui/Badge.js";
import { NativeSelect, NativeSelectOption } from "zudoku/ui/NativeSelect.js";
import { SyntaxHighlight } from "../../ui/SyntaxHighlight.js";
import { NonHighlightedCode } from "./components/NonHighlightedCode.js";
import * as SidecarBox from "./SidecarBox.js";
const formatForDisplay = (value) => {
    if (value == null)
        return;
    if (typeof value === "string")
        return value.trim();
    return JSON.stringify(value, null, 2);
};
const getLanguage = (mediaType) => {
    if (!mediaType)
        return "plain";
    if (mediaType.endsWith("+json"))
        return "json";
    if (mediaType.endsWith("+xml"))
        return "xml";
    if (mediaType.endsWith("+yaml"))
        return "yaml";
    const languages = {
        "text/html": "html",
        "application/x-ndjson": "json",
        "application/json": "json",
        "application/xml": "xml",
        "application/x-yaml": "yaml",
        "text/csv": "csv",
        "application/javascript": "javascript",
        "application/graphql": "graphql",
    };
    return languages[mediaType] ?? "plain";
};
export const SidecarExamples = ({ content, description, onExampleChange, selectedContentIndex, selectedExampleIndex, isOnScreen, shouldLazyHighlight, }) => {
    // Get example value, with fallback to schema-generated example
    const selectedContent = content[selectedContentIndex];
    const examples = selectedContent?.examples ?? [];
    const selectedExample = examples?.[selectedExampleIndex];
    const formattedExample = formatForDisplay(selectedExample?.value);
    const language = getLanguage(selectedContent?.mediaType);
    return (_jsxs(_Fragment, { children: [_jsxs(SidecarBox.Body, { className: "p-0", children: [selectedExample?.externalValue ? (_jsx("div", { className: "p-4", children: _jsxs("a", { href: selectedExample.externalValue, target: "_blank", rel: "noopener noreferrer", className: "text-xs text-primary hover:underline", children: ["View External Example", _jsx(ExternalLinkIcon, { className: "size-3 inline-block ms-1 align-[-0.125em]" })] }) })) : shouldLazyHighlight && !isOnScreen && formattedExample ? (_jsx(NonHighlightedCode, { code: formattedExample })) : formattedExample ? (_jsx(SyntaxHighlight, { embedded: true, language: language, className: "[--scrollbar-color:gray] rounded-none max-h-[200px] text-xs overflow-auto", code: formattedExample })) : (_jsx("div", { className: "grid place-items-center text-xs text-muted-foreground min-h-18", children: "No example specified for this content type" })), selectedExample?.description && (_jsx("div", { className: "border-t text-xs px-3 py-1.5 text-muted-foreground", children: selectedExample.description }))] }), _jsxs(SidecarBox.Footer, { className: "text-xs", children: [description && (_jsx("div", { className: "text-muted-foreground text-xs px-1 py-2", children: description })), (examples.length !== 0 || content.length !== 0) && (_jsxs("div", { className: "flex items-center gap-2 justify-between min-w-0", children: [_jsx("div", { className: "flex items-center gap-2 flex-wrap", children: content.length > 1 ? (_jsx(NativeSelect, { className: "text-xs h-fit py-1 truncate bg-background", value: selectedContentIndex.toString(), onChange: (e) => onExampleChange?.({
                                        contentTypeIndex: Number(e.target.value),
                                        exampleIndex: 0,
                                    }), children: content.map((c, index) => (_jsx(NativeSelectOption, { value: index.toString(), children: c.mediaType }, c.mediaType))) })) : (_jsx(Badge, { className: "text-[11px] font-mono font-normal", variant: "outline", children: content[0]?.mediaType })) }), examples.length > 1 && (_jsx(NativeSelect, { className: "text-xs h-fit py-1 truncate bg-background", value: selectedExampleIndex.toString(), onChange: (e) => onExampleChange?.({
                                    contentTypeIndex: selectedContentIndex,
                                    exampleIndex: Number(e.target.value),
                                }), children: examples.map((example, index) => (_jsx(NativeSelectOption, { value: index.toString(), children: example.summary ||
                                        example.name ||
                                        example.description ||
                                        `Example ${index + 1}` }, example.summary ||
                                    example.name ||
                                    example.description ||
                                    `Example ${index + 1}`))) }))] }))] })] }));
};
//# sourceMappingURL=SidecarExamples.js.map