import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { PaperclipIcon, TrashIcon } from "lucide-react";
import { useRef } from "react";
import { Button } from "zudoku/components";
import { Checkbox } from "zudoku/ui/Checkbox.js";
import { humanFileSize } from "../../../../util/humanFileSize.js";
import { ParamsGridInput, ParamsGridItem, ParamsGridRemoveButton, } from "../ParamsGrid.js";
export const MultipartField = ({ index, manager }) => {
    const fieldFileInputRef = useRef(null);
    const fieldValue = manager.getValue(index, "value");
    return (_jsxs(ParamsGridItem, { children: [_jsx(Checkbox, { ...manager.getCheckboxProps(index), disabled: !manager.getValue(index, "name") }), _jsx(ParamsGridInput, { ...manager.getNameInputProps(index), placeholder: "Key" }), _jsxs("div", { className: "flex items-center gap-1 flex-1", children: [fieldValue instanceof File ? (_jsxs("div", { className: "flex items-center gap-1 flex-1 min-w-0", children: [_jsxs("div", { className: "flex items-center gap-1 border-b cursor-default", children: [_jsx(PaperclipIcon, { size: 12, className: "text-muted-foreground" }), _jsx("span", { className: "text-xs truncate", title: `${fieldValue.name} (${humanFileSize(fieldValue.size)})`, children: fieldValue.name })] }), _jsx(Button, { type: "button", variant: "ghost", size: "icon-xs", className: "opacity-50 hover:opacity-100 hover:brightness-95 transition-opacity", onClick: () => manager.setValue(index, "value", ""), children: _jsx(TrashIcon, { size: 13 }) })] })) : (_jsxs(_Fragment, { children: [_jsx(ParamsGridInput, { ...manager.getValueInputProps(index), placeholder: "Value" }), _jsx("input", { ref: fieldFileInputRef, type: "file", className: "hidden", onChange: (e) => {
                                    const file = e.target.files?.[0];
                                    if (!file)
                                        return;
                                    manager.setValue(index, "value", file);
                                    manager.setValue(index, "active", true);
                                } }), _jsx(Button, { type: "button", variant: "ghost", size: "icon-xs", onClick: () => fieldFileInputRef.current?.click(), title: "Attach file", className: "opacity-0 focus-visible:opacity-100 group-hover:opacity-100 group-hover:brightness-95 transition-opacity", children: _jsx(PaperclipIcon, { size: 14 }) })] })), _jsx(ParamsGridRemoveButton, { ...manager.getRemoveButtonProps(index) })] })] }));
};
//# sourceMappingURL=MultipartField.js.map