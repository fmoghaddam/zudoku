{"version":3,"file":"EmbeddedCodeBlock.js","sources":["../../src/lib/ui/EmbeddedCodeBlock.tsx"],"sourcesContent":["import { CheckIcon, CopyIcon } from \"lucide-react\";\nimport type { ReactNode } from \"react\";\nimport { useRef, useState } from \"react\";\nimport { cn } from \"../util/cn.js\";\nimport { Button } from \"./Button.js\";\n\nexport type CodeBlockProps = {\n  className?: string;\n  wrapLines?: boolean;\n  showLanguageIndicator?: boolean;\n  language?: string;\n  children?: ReactNode;\n  code?: ReactNode;\n  showCopy?: \"hover\" | \"always\" | \"never\";\n  showCopyText?: boolean;\n  disabled?: boolean;\n  showLineNumbers?: boolean;\n};\n\nexport const EmbeddedCodeBlock = ({\n  children,\n  fullHeight,\n  language,\n  showCopy = \"hover\",\n  showCopyText,\n  showLanguageIndicator = true,\n  showLineNumbers,\n  ...props\n}: CodeBlockProps & { fullHeight?: boolean }) => {\n  const [isCopied, setIsCopied] = useState(false);\n  const ref = useRef<HTMLDivElement>(null);\n\n  if (!children) return null;\n\n  return (\n    <div\n      className={cn(\n        \"code-block-wrapper relative group bg-muted/50\",\n        showLineNumbers && \"line-numbers\",\n        fullHeight && \"h-full\",\n      )}\n    >\n      <div className=\"relative overflow-auto\">\n        <div\n          className={cn(\n            \"code-block text-sm not-prose scrollbar [&>pre]:overflow-x-auto [&_code]:p-2\",\n            fullHeight && \"h-full [&>pre]:h-full\",\n            props.className,\n          )}\n          ref={ref}\n        >\n          {children}\n        </div>\n      </div>\n      {showLanguageIndicator && (\n        <span\n          className={cn(\n            \"absolute top-1.5 end-3 text-[11px]! font-mono text-muted-foreground transition group-hover:opacity-0 pointer-events-none\",\n            showCopy === \"always\" && \"hidden\",\n          )}\n        >\n          {language}\n        </span>\n      )}\n      {showCopy !== \"never\" && (\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          size=\"icon-xs\"\n          className={cn(\n            \"absolute top-2 end-2 p-2\",\n            showCopy === \"hover\" && \"opacity-0 group-hover:opacity-100\",\n            showCopyText && \"flex gap-2 items-center font-medium\",\n          )}\n          disabled={isCopied}\n          onClick={() => {\n            if (!ref.current?.textContent) return;\n\n            setIsCopied(true);\n            void navigator.clipboard.writeText(ref.current.textContent);\n            setTimeout(() => setIsCopied(false), 2000);\n          }}\n        >\n          {isCopied ? (\n            <CheckIcon\n              className=\"shrink-0 text-emerald-600 dark:text-emerald-300\"\n              size={13}\n              strokeWidth={2.5}\n              absoluteStrokeWidth\n            />\n          ) : (\n            <CopyIcon className=\"shrink-0\" size={13} />\n          )}\n          {showCopyText && \"Copy\"}\n        </Button>\n      )}\n    </div>\n  );\n};\n"],"names":["EmbeddedCodeBlock","children","fullHeight","language","showCopy","showCopyText","showLanguageIndicator","showLineNumbers","props","isCopied","setIsCopied","useState","ref","useRef","jsxs","cn","jsx","Button","CheckIcon","CopyIcon"],"mappings":";;;;;AAmBO,MAAMA,IAAoB,CAAC;AAAA,EAChC,UAAAC;AAAA,EACA,YAAAC;AAAA,EACA,UAAAC;AAAA,EACA,UAAAC,IAAW;AAAA,EACX,cAAAC;AAAA,EACA,uBAAAC,IAAwB;AAAA,EACxB,iBAAAC;AAAA,EACA,GAAGC;AACL,MAAiD;AAC/C,QAAM,CAACC,GAAUC,CAAW,IAAIC,EAAS,EAAK,GACxCC,IAAMC,EAAuB,IAAI;AAEvC,SAAKZ,IAGHa,gBAAAA,EAAAA;AAAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWC;AAAA,QACT;AAAA,QACAR,KAAmB;AAAA,QACnBL,KAAc;AAAA,MAAA;AAAA,MAGhB,UAAA;AAAA,QAAAc,gBAAAA,EAAAA,IAAC,OAAA,EAAI,WAAU,0BACb,UAAAA,gBAAAA,EAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAWD;AAAA,cACT;AAAA,cACAb,KAAc;AAAA,cACdM,EAAM;AAAA,YAAA;AAAA,YAER,KAAAI;AAAA,YAEC,UAAAX;AAAA,UAAA;AAAA,QAAA,GAEL;AAAA,QACCK,KACCU,gBAAAA,EAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAWD;AAAA,cACT;AAAA,cACAX,MAAa,YAAY;AAAA,YAAA;AAAA,YAG1B,UAAAD;AAAA,UAAA;AAAA,QAAA;AAAA,QAGJC,MAAa,WACZU,gBAAAA,EAAAA;AAAAA,UAACG;AAAA,UAAA;AAAA,YACC,MAAK;AAAA,YACL,SAAQ;AAAA,YACR,MAAK;AAAA,YACL,WAAWF;AAAA,cACT;AAAA,cACAX,MAAa,WAAW;AAAA,cACxBC,KAAgB;AAAA,YAAA;AAAA,YAElB,UAAUI;AAAA,YACV,SAAS,MAAM;AACb,cAAKG,EAAI,SAAS,gBAElBF,EAAY,EAAI,GACX,UAAU,UAAU,UAAUE,EAAI,QAAQ,WAAW,GAC1D,WAAW,MAAMF,EAAY,EAAK,GAAG,GAAI;AAAA,YAC3C;AAAA,YAEC,UAAA;AAAA,cAAAD,IACCO,gBAAAA,EAAAA;AAAAA,gBAACE;AAAA,gBAAA;AAAA,kBACC,WAAU;AAAA,kBACV,MAAM;AAAA,kBACN,aAAa;AAAA,kBACb,qBAAmB;AAAA,gBAAA;AAAA,cAAA,IAGrBF,gBAAAA,EAAAA,IAACG,GAAA,EAAS,WAAU,YAAW,MAAM,IAAI;AAAA,cAE1Cd,KAAgB;AAAA,YAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MACnB;AAAA,IAAA;AAAA,EAAA,IA9DgB;AAkExB;"}