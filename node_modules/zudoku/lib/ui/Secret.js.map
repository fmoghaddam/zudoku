{"version":3,"file":"Secret.js","sources":["../../src/lib/ui/Secret.tsx"],"sourcesContent":["import { CheckIcon, CopyIcon, EyeIcon, EyeOffIcon } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { cn } from \"../util/cn.js\";\nimport { useCopyToClipboard } from \"../util/useCopyToClipboard.js\";\nimport { Button } from \"./Button.js\";\n\ntype Status = \"active\" | \"expired\" | \"expiring\" | \"revoked\" | \"none\";\n\nexport const SecretText = ({\n  secret,\n  revealed = false,\n  previewChars = 5,\n  className,\n}: {\n  secret: string;\n  revealed?: boolean;\n  previewChars?: number;\n  className?: string;\n}) => {\n  if (revealed) {\n    return <span className={className}>{secret}</span>;\n  }\n\n  const hiddenPart =\n    \"•••• \".repeat(secret.slice(0, -previewChars).length / 5) +\n    \"•\".repeat(secret.slice(0, -previewChars).length % 5);\n  const visiblePart = previewChars > 0 ? secret.slice(-previewChars) : \"\";\n\n  return (\n    <span\n      className={cn(\n        \"block overflow-hidden text-ellipsis whitespace-nowrap\",\n        className,\n      )}\n      dir=\"rtl\"\n    >\n      <span dir=\"ltr\" className=\"inline\">\n        <span className=\"opacity-50\">{hiddenPart}</span>\n        {visiblePart && <span>{visiblePart}</span>}\n      </span>\n    </span>\n  );\n};\n\nexport const Secret = ({\n  secret,\n  preview = 5,\n  className,\n  status,\n  onCopy,\n  revealed: controlledRevealed,\n  onReveal,\n  noReveal: disabledReveal,\n}: {\n  revealed?: boolean;\n  noReveal?: boolean;\n  secret: string;\n  status?: Status;\n  className?: string;\n  preview?: number;\n  onCopy?: (secret: string) => void;\n  onReveal?: (revealed: boolean) => void;\n}) => {\n  const previewChars = Math.abs(preview);\n  const [isRevealed, setRevealed] = useState(false);\n  const [isCopied, copyToClipboard] = useCopyToClipboard();\n\n  const revealed = controlledRevealed ?? isRevealed;\n\n  return (\n    <div\n      className={cn(\n        \"flex gap-2 items-center text-sm border rounded-md px-1\",\n        className,\n      )}\n    >\n      <div\n        className={cn(\n          \"font-mono w-full h-9 items-center flex px-2 text-xs gap-2 min-w-0\",\n          revealed ? \"overflow-x-auto\" : \"overflow-hidden\",\n        )}\n      >\n        {status && (\n          <div\n            className={cn(\n              \"rounded-full shrink-0 w-2 h-2 mr-2\",\n              status === \"active\" && \"bg-emerald-400\",\n              status === \"expired\" && \"bg-neutral-200\",\n              status === \"expiring\" && \"bg-yellow-400\",\n              status === \"revoked\" && \"bg-red-400\",\n              status === \"none\" && \"opacity-0\",\n            )}\n          />\n        )}\n        <SecretText\n          secret={secret}\n          revealed={revealed}\n          previewChars={previewChars}\n        />\n      </div>\n      {disabledReveal !== true && (\n        <Button\n          variant=\"ghost\"\n          onClick={() => {\n            setRevealed((prev) => !prev);\n            onReveal?.(!revealed);\n          }}\n          size=\"icon-xxs\"\n        >\n          {revealed ? (\n            <EyeOffIcon className=\"size-3.5\" />\n          ) : (\n            <EyeIcon className=\"size-3.5\" />\n          )}\n        </Button>\n      )}\n      <Button\n        variant=\"ghost\"\n        onClick={() => {\n          copyToClipboard(secret);\n          onCopy?.(secret);\n        }}\n        size=\"icon-xxs\"\n      >\n        {isCopied ? (\n          <CheckIcon className=\"size-3.5\" />\n        ) : (\n          <CopyIcon className=\"size-3.5\" />\n        )}\n      </Button>\n    </div>\n  );\n};\n"],"names":["SecretText","secret","revealed","previewChars","className","jsx","hiddenPart","visiblePart","cn","jsxs","Secret","preview","status","onCopy","controlledRevealed","onReveal","disabledReveal","isRevealed","setRevealed","useState","isCopied","copyToClipboard","useCopyToClipboard","Button","prev","EyeOffIcon","EyeIcon","CheckIcon","CopyIcon"],"mappings":"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"}