{"version":3,"file":"DismissibleAlert.js","sources":["../../src/lib/ui/DismissibleAlert.tsx"],"sourcesContent":["import { Slot } from \"@radix-ui/react-slot\";\nimport { XIcon } from \"lucide-react\";\nimport {\n  createContext,\n  type PropsWithChildren,\n  use,\n  useCallback,\n  useState,\n} from \"react\";\nimport { useLatest } from \"../util/useLatest.js\";\nimport { Alert, AlertAction } from \"./Alert.js\";\nimport { Button } from \"./Button.js\";\n\ntype DismissibleAlertContextValue = { dismiss: () => void };\n\nconst DismissibleAlertContext = createContext<DismissibleAlertContextValue>({\n  dismiss: () => {},\n});\n\nconst useDismissibleAlertContext = () => use(DismissibleAlertContext);\n\ntype DismissibleAlertProps = React.ComponentProps<typeof Alert> & {\n  onDismiss?: () => void;\n};\n\nconst DismissibleAlert = ({ onDismiss, ...props }: DismissibleAlertProps) => {\n  const [isDismissed, setIsDismissed] = useState(false);\n  const latestOnDismiss = useLatest(onDismiss);\n\n  const dismiss = useCallback(() => {\n    setIsDismissed(true);\n    latestOnDismiss.current?.();\n  }, [latestOnDismiss]);\n\n  if (isDismissed) return null;\n\n  return (\n    <DismissibleAlertContext value={{ dismiss }}>\n      <Alert {...props} />\n    </DismissibleAlertContext>\n  );\n};\n\ntype DismissibleAlertCloseProps = React.ComponentProps<typeof Button> & {\n  asChild?: boolean;\n};\n\nconst DismissibleAlertCloseButton = ({\n  asChild,\n  ...props\n}: DismissibleAlertCloseProps) => {\n  const { dismiss } = useDismissibleAlertContext();\n  const Comp = asChild ? Slot : Button;\n\n  return <Comp onClick={dismiss} {...props} />;\n};\n\nconst DismissibleAlertAction = ({ children }: PropsWithChildren) => (\n  <AlertAction>\n    <DismissibleAlertCloseButton\n      variant=\"ghost\"\n      size=\"icon-xxs\"\n      className=\"hover:text-current hover:bg-[color-mix(in_srgb,currentColor_10%,transparent)]!\"\n    >\n      {children ?? <XIcon className=\"size-3.5\" />}\n    </DismissibleAlertCloseButton>\n  </AlertAction>\n);\n\nexport {\n  DismissibleAlert,\n  DismissibleAlertCloseButton as DismissibleAlertClose,\n  DismissibleAlertAction,\n};\n"],"names":["DismissibleAlertContext","createContext","useDismissibleAlertContext","use","DismissibleAlert","onDismiss","props","isDismissed","setIsDismissed","useState","latestOnDismiss","useLatest","dismiss","useCallback","jsx","Alert","DismissibleAlertCloseButton","asChild","Comp","Slot","Button","DismissibleAlertAction","children","AlertAction","XIcon"],"mappings":";;;;;;;AAeA,MAAMA,IAA0BC,EAA4C;AAAA,EAC1E,SAAS,MAAM;AAAA,EAAC;AAClB,CAAC,GAEKC,IAA6B,MAAMC,EAAIH,CAAuB,GAM9DI,IAAmB,CAAC,EAAE,WAAAC,GAAW,GAAGC,QAAmC;AAC3E,QAAM,CAACC,GAAaC,CAAc,IAAIC,EAAS,EAAK,GAC9CC,IAAkBC,EAAUN,CAAS,GAErCO,IAAUC,EAAY,MAAM;AAChC,IAAAL,EAAe,EAAI,GACnBE,EAAgB,UAAA;AAAA,EAClB,GAAG,CAACA,CAAe,CAAC;AAEpB,SAAIH,IAAoB,OAGtBO,gBAAAA,EAAAA,IAACd,GAAA,EAAwB,OAAO,EAAE,SAAAY,EAAA,GAChC,UAAAE,gBAAAA,EAAAA,IAACC,GAAA,EAAO,GAAGT,EAAA,CAAO,EAAA,CACpB;AAEJ,GAMMU,IAA8B,CAAC;AAAA,EACnC,SAAAC;AAAA,EACA,GAAGX;AACL,MAAkC;AAChC,QAAM,EAAE,SAAAM,EAAA,IAAYV,EAAA,GACdgB,IAAOD,IAAUE,IAAOC;AAE9B,SAAON,gBAAAA,EAAAA,IAACI,GAAA,EAAK,SAASN,GAAU,GAAGN,GAAO;AAC5C,GAEMe,IAAyB,CAAC,EAAE,UAAAC,EAAA,4BAC/BC,GAAA,EACC,UAAAT,gBAAAA,EAAAA;AAAAA,EAACE;AAAA,EAAA;AAAA,IACC,SAAQ;AAAA,IACR,MAAK;AAAA,IACL,WAAU;AAAA,IAET,UAAAM,KAAYR,gBAAAA,EAAAA,IAACU,GAAA,EAAM,WAAU,WAAA,CAAW;AAAA,EAAA;AAC3C,EAAA,CACF;"}