{"version":3,"file":"zudoku.plugin-api-keys.js","sources":["../src/lib/errors/ErrorMessage.tsx","../src/lib/plugins/api-keys/CreateApiKey.tsx","../src/lib/plugins/api-keys/CreateApiKeyDialog.tsx","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/context/LayoutGroupContext.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/utils/use-constant.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/utils/is-browser.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/utils/use-isomorphic-effect.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/context/PresenceContext.mjs","../../../node_modules/.pnpm/motion-utils@12.29.2/node_modules/motion-utils/dist/es/is-object.mjs","../../../node_modules/.pnpm/motion-dom@12.30.0/node_modules/motion-dom/dist/es/utils/is-html-element.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/context/MotionConfigContext.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/utils/use-composed-ref.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/components/AnimatePresence/PopChild.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/components/AnimatePresence/PresenceChild.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/components/AnimatePresence/use-presence.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/components/AnimatePresence/utils.mjs","../../../node_modules/.pnpm/framer-motion@12.30.0_@emotion+is-prop-valid@0.8.8_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/framer-motion/dist/es/components/AnimatePresence/index.mjs","../src/lib/plugins/api-keys/settings/RevealApiKey.tsx","../src/lib/plugins/api-keys/settings/ApiKeyItem.tsx","../src/lib/plugins/api-keys/settings/ApiKeyList.tsx","../src/lib/plugins/api-keys/SettingsApiKeys.tsx","../src/lib/plugins/api-keys/index.tsx"],"sourcesContent":["import { Alert, AlertDescription, AlertTitle } from \"zudoku/ui/Alert.js\";\nimport { SyntaxHighlight } from \"zudoku/ui/SyntaxHighlight.js\";\nimport { DeveloperHint } from \"../components/DeveloperHint.js\";\nimport { ZudokuError } from \"../util/invariant.js\";\n\nexport function ErrorMessage({ error }: { error: unknown }) {\n  const message =\n    error instanceof Error ? error.message : \"Something went wrong\";\n\n  const showDeveloperHints = process.env.NODE_ENV === \"development\";\n\n  const hint = error instanceof ZudokuError ? error.developerHint : undefined;\n  const title =\n    error instanceof ZudokuError ? error.title : \"Something went wrong\";\n  const stack = error instanceof Error ? error.stack : undefined;\n  const cause = error instanceof Error ? error.cause : undefined;\n\n  const stringError = cause instanceof Error ? String(cause.stack) : stack;\n\n  return (\n    <>\n      <Alert variant=\"destructive\">\n        <AlertTitle>{title}</AlertTitle>\n        <AlertDescription>{message}</AlertDescription>\n      </Alert>\n      {showDeveloperHints && hint && (\n        <DeveloperHint className=\"mb-4\">{hint}</DeveloperHint>\n      )}\n      {showDeveloperHints && stringError && (\n        <SyntaxHighlight\n          className=\"max-h-[400px] [&>pre]:p-4\"\n          language=\"js\"\n          code={stringError}\n        />\n      )}\n    </>\n  );\n}\n","import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { useNavigate } from \"react-router\";\nimport { ActionButton } from \"zudoku/ui/ActionButton.js\";\nimport { Alert, AlertDescription, AlertTitle } from \"zudoku/ui/Alert.js\";\nimport { DialogClose, DialogFooter } from \"zudoku/ui/Dialog.js\";\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"zudoku/ui/Select.js\";\nimport { useZudoku } from \"../../components/context/ZudokuContext.js\";\nimport { useAuth } from \"../../hooks/index.js\";\nimport { Button } from \"../../ui/Button.js\";\nimport { Input } from \"../../ui/Input.js\";\nimport type { ApiKeyService } from \"./index.js\";\n\ntype CreateApiKey = { description?: string; expiresOn?: string };\n\nexport const CreateApiKey = ({\n  service,\n  onOpenChange,\n}: {\n  service: ApiKeyService;\n  onOpenChange: (open: boolean) => void;\n}) => {\n  const context = useZudoku();\n  const queryClient = useQueryClient();\n  const navigate = useNavigate();\n  const form = useForm<CreateApiKey>({\n    defaultValues: {\n      expiresOn: \"30\",\n    },\n  });\n  const auth = useAuth();\n\n  const createKeyMutation = useMutation({\n    mutationFn: ({ description, expiresOn }: CreateApiKey) => {\n      if (!service.createKey) {\n        throw new Error(\"createKey not implemented\");\n      }\n\n      const expiresOnDate =\n        expiresOn !== \"never\" ? addDaysToDate(Number(expiresOn)) : undefined;\n\n      return service.createKey({\n        apiKey: {\n          description: description || \"Secret Key\",\n          expiresOn: expiresOnDate,\n        },\n        context,\n        auth,\n      });\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"api-keys\"] });\n      await navigate(\"/settings/api-keys/\");\n    },\n  });\n\n  if (!service.createKey) {\n    return null;\n  }\n\n  return (\n    <form\n      onSubmit={form.handleSubmit((data) =>\n        createKeyMutation.mutate(\n          { ...data },\n          {\n            onSuccess: () => onOpenChange(false),\n          },\n        ),\n      )}\n    >\n      {createKeyMutation.error && (\n        <Alert variant=\"destructive\" className=\"mb-4\">\n          <AlertTitle>Error</AlertTitle>\n          <AlertDescription>{createKeyMutation.error.message}</AlertDescription>\n        </Alert>\n      )}\n      <div className=\"flex gap-2 flex-col text-sm font-medium\">\n        Name\n        <Input {...form.register(\"description\")} />\n        Expiration\n        <Select\n          onValueChange={(value) => form.setValue(\"expiresOn\", value)}\n          defaultValue={form.getValues(\"expiresOn\")}\n        >\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectGroup>\n              {[7, 30, 60, 90].map((option) => (\n                <SelectItem value={String(option)} key={option}>\n                  {option} days\n                </SelectItem>\n              ))}\n              <SelectItem value=\"never\">Never</SelectItem>\n            </SelectGroup>\n          </SelectContent>\n        </Select>\n        <DialogFooter>\n          <DialogClose asChild>\n            <Button variant=\"outline\">Cancel</Button>\n          </DialogClose>\n          <ActionButton isPending={createKeyMutation.isPending}>\n            Generate Key\n          </ActionButton>\n        </DialogFooter>\n      </div>\n    </form>\n  );\n};\n\nconst addDaysToDate = (days: number): string => {\n  const date = new Date();\n  date.setDate(date.getDate() + days);\n  return date.toISOString();\n};\n","import type { ReactNode } from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"zudoku/ui/Dialog.js\";\nimport { Button } from \"../../ui/Button.js\";\nimport { CreateApiKey } from \"./CreateApiKey.js\";\nimport type { ApiKeyService } from \"./index.js\";\n\ninterface CreateApiKeyDialogProps {\n  service: ApiKeyService;\n  isOpen: boolean;\n  onOpenChange: (open: boolean) => void;\n  trigger?: ReactNode;\n  buttonVariant?:\n    | \"default\"\n    | \"destructive\"\n    | \"outline\"\n    | \"secondary\"\n    | \"ghost\"\n    | \"link\";\n}\n\nexport const CreateApiKeyDialog = ({\n  service,\n  isOpen,\n  onOpenChange,\n  trigger,\n  buttonVariant = \"outline\",\n}: CreateApiKeyDialogProps) => {\n  const defaultTrigger = (\n    <Button variant={buttonVariant}>Create API Key</Button>\n  );\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onOpenChange}>\n      <DialogTrigger asChild>{trigger ?? defaultTrigger}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Create API Key</DialogTitle>\n        </DialogHeader>\n        <CreateApiKey service={service} onOpenChange={onOpenChange} />\n      </DialogContent>\n    </Dialog>\n  );\n};\n","\"use client\";\nimport { createContext } from 'react';\n\nconst LayoutGroupContext = createContext({});\n\nexport { LayoutGroupContext };\n//# sourceMappingURL=LayoutGroupContext.mjs.map\n","\"use client\";\nimport { useRef } from 'react';\n\n/**\n * Creates a constant value over the lifecycle of a component.\n *\n * Even if `useMemo` is provided an empty array as its final argument, it doesn't offer\n * a guarantee that it won't re-run for performance reasons later on. By using `useConstant`\n * you can ensure that initialisers don't execute twice or more.\n */\nfunction useConstant(init) {\n    const ref = useRef(null);\n    if (ref.current === null) {\n        ref.current = init();\n    }\n    return ref.current;\n}\n\nexport { useConstant };\n//# sourceMappingURL=use-constant.mjs.map\n","const isBrowser = typeof window !== \"undefined\";\n\nexport { isBrowser };\n//# sourceMappingURL=is-browser.mjs.map\n","\"use client\";\nimport { useLayoutEffect, useEffect } from 'react';\nimport { isBrowser } from './is-browser.mjs';\n\nconst useIsomorphicLayoutEffect = isBrowser ? useLayoutEffect : useEffect;\n\nexport { useIsomorphicLayoutEffect };\n//# sourceMappingURL=use-isomorphic-effect.mjs.map\n","\"use client\";\nimport { createContext } from 'react';\n\n/**\n * @public\n */\nconst PresenceContext = \n/* @__PURE__ */ createContext(null);\n\nexport { PresenceContext };\n//# sourceMappingURL=PresenceContext.mjs.map\n","function isObject(value) {\n    return typeof value === \"object\" && value !== null;\n}\n\nexport { isObject };\n//# sourceMappingURL=is-object.mjs.map\n","import { isObject } from 'motion-utils';\n\n/**\n * Checks if an element is an HTML element in a way\n * that works across iframes\n */\nfunction isHTMLElement(element) {\n    return isObject(element) && \"offsetHeight\" in element;\n}\n\nexport { isHTMLElement };\n//# sourceMappingURL=is-html-element.mjs.map\n","\"use client\";\nimport { createContext } from 'react';\n\n/**\n * @public\n */\nconst MotionConfigContext = createContext({\n    transformPagePoint: (p) => p,\n    isStatic: false,\n    reducedMotion: \"never\",\n});\n\nexport { MotionConfigContext };\n//# sourceMappingURL=MotionConfigContext.mjs.map\n","import * as React from 'react';\n\n/**\n * Taken from https://github.com/radix-ui/primitives/blob/main/packages/react/compose-refs/src/compose-refs.tsx\n */\n/**\n * Set a given ref to a given value\n * This utility takes care of different types of refs: callback refs and RefObject(s)\n */\nfunction setRef(ref, value) {\n    if (typeof ref === \"function\") {\n        return ref(value);\n    }\n    else if (ref !== null && ref !== undefined) {\n        ref.current = value;\n    }\n}\n/**\n * A utility to compose multiple refs together\n * Accepts callback refs and RefObject(s)\n */\nfunction composeRefs(...refs) {\n    return (node) => {\n        let hasCleanup = false;\n        const cleanups = refs.map((ref) => {\n            const cleanup = setRef(ref, node);\n            if (!hasCleanup && typeof cleanup === \"function\") {\n                hasCleanup = true;\n            }\n            return cleanup;\n        });\n        // React <19 will log an error to the console if a callback ref returns a\n        // value. We don't use ref cleanups internally so this will only happen if a\n        // user's ref callback returns a value, which we only expect if they are\n        // using the cleanup functionality added in React 19.\n        if (hasCleanup) {\n            return () => {\n                for (let i = 0; i < cleanups.length; i++) {\n                    const cleanup = cleanups[i];\n                    if (typeof cleanup === \"function\") {\n                        cleanup();\n                    }\n                    else {\n                        setRef(refs[i], null);\n                    }\n                }\n            };\n        }\n    };\n}\n/**\n * A custom hook that composes multiple refs\n * Accepts callback refs and RefObject(s)\n */\nfunction useComposedRefs(...refs) {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    return React.useCallback(composeRefs(...refs), refs);\n}\n\nexport { useComposedRefs };\n//# sourceMappingURL=use-composed-ref.mjs.map\n","\"use client\";\nimport { jsx } from 'react/jsx-runtime';\nimport { isHTMLElement } from 'motion-dom';\nimport * as React from 'react';\nimport { useId, useRef, useContext, useInsertionEffect } from 'react';\nimport { MotionConfigContext } from '../../context/MotionConfigContext.mjs';\nimport { useComposedRefs } from '../../utils/use-composed-ref.mjs';\n\n/**\n * Measurement functionality has to be within a separate component\n * to leverage snapshot lifecycle.\n */\nclass PopChildMeasure extends React.Component {\n    getSnapshotBeforeUpdate(prevProps) {\n        const element = this.props.childRef.current;\n        if (element && prevProps.isPresent && !this.props.isPresent) {\n            const parent = element.offsetParent;\n            const parentWidth = isHTMLElement(parent)\n                ? parent.offsetWidth || 0\n                : 0;\n            const parentHeight = isHTMLElement(parent)\n                ? parent.offsetHeight || 0\n                : 0;\n            const size = this.props.sizeRef.current;\n            size.height = element.offsetHeight || 0;\n            size.width = element.offsetWidth || 0;\n            size.top = element.offsetTop;\n            size.left = element.offsetLeft;\n            size.right = parentWidth - size.width - size.left;\n            size.bottom = parentHeight - size.height - size.top;\n        }\n        return null;\n    }\n    /**\n     * Required with getSnapshotBeforeUpdate to stop React complaining.\n     */\n    componentDidUpdate() { }\n    render() {\n        return this.props.children;\n    }\n}\nfunction PopChild({ children, isPresent, anchorX, anchorY, root }) {\n    const id = useId();\n    const ref = useRef(null);\n    const size = useRef({\n        width: 0,\n        height: 0,\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n    });\n    const { nonce } = useContext(MotionConfigContext);\n    /**\n     * In React 19, refs are passed via props.ref instead of element.ref.\n     * We check props.ref first (React 19) and fall back to element.ref (React 18).\n     */\n    const childRef = children.props?.ref ??\n        children?.ref;\n    const composedRef = useComposedRefs(ref, childRef);\n    /**\n     * We create and inject a style block so we can apply this explicit\n     * sizing in a non-destructive manner by just deleting the style block.\n     *\n     * We can't apply size via render as the measurement happens\n     * in getSnapshotBeforeUpdate (post-render), likewise if we apply the\n     * styles directly on the DOM node, we might be overwriting\n     * styles set via the style prop.\n     */\n    useInsertionEffect(() => {\n        const { width, height, top, left, right, bottom } = size.current;\n        if (isPresent || !ref.current || !width || !height)\n            return;\n        const x = anchorX === \"left\" ? `left: ${left}` : `right: ${right}`;\n        const y = anchorY === \"bottom\" ? `bottom: ${bottom}` : `top: ${top}`;\n        ref.current.dataset.motionPopId = id;\n        const style = document.createElement(\"style\");\n        if (nonce)\n            style.nonce = nonce;\n        const parent = root ?? document.head;\n        parent.appendChild(style);\n        if (style.sheet) {\n            style.sheet.insertRule(`\n          [data-motion-pop-id=\"${id}\"] {\n            position: absolute !important;\n            width: ${width}px !important;\n            height: ${height}px !important;\n            ${x}px !important;\n            ${y}px !important;\n          }\n        `);\n        }\n        return () => {\n            if (parent.contains(style)) {\n                parent.removeChild(style);\n            }\n        };\n    }, [isPresent]);\n    return (jsx(PopChildMeasure, { isPresent: isPresent, childRef: ref, sizeRef: size, children: React.cloneElement(children, { ref: composedRef }) }));\n}\n\nexport { PopChild };\n//# sourceMappingURL=PopChild.mjs.map\n","\"use client\";\nimport { jsx } from 'react/jsx-runtime';\nimport * as React from 'react';\nimport { useId, useMemo } from 'react';\nimport { PresenceContext } from '../../context/PresenceContext.mjs';\nimport { useConstant } from '../../utils/use-constant.mjs';\nimport { PopChild } from './PopChild.mjs';\n\nconst PresenceChild = ({ children, initial, isPresent, onExitComplete, custom, presenceAffectsLayout, mode, anchorX, anchorY, root }) => {\n    const presenceChildren = useConstant(newChildrenMap);\n    const id = useId();\n    let isReusedContext = true;\n    let context = useMemo(() => {\n        isReusedContext = false;\n        return {\n            id,\n            initial,\n            isPresent,\n            custom,\n            onExitComplete: (childId) => {\n                presenceChildren.set(childId, true);\n                for (const isComplete of presenceChildren.values()) {\n                    if (!isComplete)\n                        return; // can stop searching when any is incomplete\n                }\n                onExitComplete && onExitComplete();\n            },\n            register: (childId) => {\n                presenceChildren.set(childId, false);\n                return () => presenceChildren.delete(childId);\n            },\n        };\n    }, [isPresent, presenceChildren, onExitComplete]);\n    /**\n     * If the presence of a child affects the layout of the components around it,\n     * we want to make a new context value to ensure they get re-rendered\n     * so they can detect that layout change.\n     */\n    if (presenceAffectsLayout && isReusedContext) {\n        context = { ...context };\n    }\n    useMemo(() => {\n        presenceChildren.forEach((_, key) => presenceChildren.set(key, false));\n    }, [isPresent]);\n    /**\n     * If there's no `motion` components to fire exit animations, we want to remove this\n     * component immediately.\n     */\n    React.useEffect(() => {\n        !isPresent &&\n            !presenceChildren.size &&\n            onExitComplete &&\n            onExitComplete();\n    }, [isPresent]);\n    if (mode === \"popLayout\") {\n        children = (jsx(PopChild, { isPresent: isPresent, anchorX: anchorX, anchorY: anchorY, root: root, children: children }));\n    }\n    return (jsx(PresenceContext.Provider, { value: context, children: children }));\n};\nfunction newChildrenMap() {\n    return new Map();\n}\n\nexport { PresenceChild };\n//# sourceMappingURL=PresenceChild.mjs.map\n","\"use client\";\nimport { useContext, useId, useEffect, useCallback } from 'react';\nimport { PresenceContext } from '../../context/PresenceContext.mjs';\n\n/**\n * When a component is the child of `AnimatePresence`, it can use `usePresence`\n * to access information about whether it's still present in the React tree.\n *\n * ```jsx\n * import { usePresence } from \"framer-motion\"\n *\n * export const Component = () => {\n *   const [isPresent, safeToRemove] = usePresence()\n *\n *   useEffect(() => {\n *     !isPresent && setTimeout(safeToRemove, 1000)\n *   }, [isPresent])\n *\n *   return <div />\n * }\n * ```\n *\n * If `isPresent` is `false`, it means that a component has been removed from the tree,\n * but `AnimatePresence` won't really remove it until `safeToRemove` has been called.\n *\n * @public\n */\nfunction usePresence(subscribe = true) {\n    const context = useContext(PresenceContext);\n    if (context === null)\n        return [true, null];\n    const { isPresent, onExitComplete, register } = context;\n    // It's safe to call the following hooks conditionally (after an early return) because the context will always\n    // either be null or non-null for the lifespan of the component.\n    const id = useId();\n    useEffect(() => {\n        if (subscribe) {\n            return register(id);\n        }\n    }, [subscribe]);\n    const safeToRemove = useCallback(() => subscribe && onExitComplete && onExitComplete(id), [id, onExitComplete, subscribe]);\n    return !isPresent && onExitComplete ? [false, safeToRemove] : [true];\n}\n/**\n * Similar to `usePresence`, except `useIsPresent` simply returns whether or not the component is present.\n * There is no `safeToRemove` function.\n *\n * ```jsx\n * import { useIsPresent } from \"framer-motion\"\n *\n * export const Component = () => {\n *   const isPresent = useIsPresent()\n *\n *   useEffect(() => {\n *     !isPresent && console.log(\"I've been removed!\")\n *   }, [isPresent])\n *\n *   return <div />\n * }\n * ```\n *\n * @public\n */\nfunction useIsPresent() {\n    return isPresent(useContext(PresenceContext));\n}\nfunction isPresent(context) {\n    return context === null ? true : context.isPresent;\n}\n\nexport { isPresent, useIsPresent, usePresence };\n//# sourceMappingURL=use-presence.mjs.map\n","import { Children, isValidElement } from 'react';\n\nconst getChildKey = (child) => child.key || \"\";\nfunction onlyElements(children) {\n    const filtered = [];\n    // We use forEach here instead of map as map mutates the component key by preprending `.$`\n    Children.forEach(children, (child) => {\n        if (isValidElement(child))\n            filtered.push(child);\n    });\n    return filtered;\n}\n\nexport { getChildKey, onlyElements };\n//# sourceMappingURL=utils.mjs.map\n","\"use client\";\nimport { jsx, Fragment } from 'react/jsx-runtime';\nimport { useMemo, useRef, useState, useContext } from 'react';\nimport { LayoutGroupContext } from '../../context/LayoutGroupContext.mjs';\nimport { useConstant } from '../../utils/use-constant.mjs';\nimport { useIsomorphicLayoutEffect } from '../../utils/use-isomorphic-effect.mjs';\nimport { PresenceChild } from './PresenceChild.mjs';\nimport { usePresence } from './use-presence.mjs';\nimport { onlyElements, getChildKey } from './utils.mjs';\n\n/**\n * `AnimatePresence` enables the animation of components that have been removed from the tree.\n *\n * When adding/removing more than a single child, every child **must** be given a unique `key` prop.\n *\n * Any `motion` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { motion, AnimatePresence } from 'framer-motion'\n *\n * export const Items = ({ items }) => (\n *   <AnimatePresence>\n *     {items.map(item => (\n *       <motion.div\n *         key={item.id}\n *         initial={{ opacity: 0 }}\n *         animate={{ opacity: 1 }}\n *         exit={{ opacity: 0 }}\n *       />\n *     ))}\n *   </AnimatePresence>\n * )\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * If a child contains multiple `motion` components with `exit` props, it will only unmount the child\n * once all `motion` components have finished animating out. Likewise, any components using\n * `usePresence` all need to call `safeToRemove`.\n *\n * @public\n */\nconst AnimatePresence = ({ children, custom, initial = true, onExitComplete, presenceAffectsLayout = true, mode = \"sync\", propagate = false, anchorX = \"left\", anchorY = \"top\", root }) => {\n    const [isParentPresent, safeToRemove] = usePresence(propagate);\n    /**\n     * Filter any children that aren't ReactElements. We can only track components\n     * between renders with a props.key.\n     */\n    const presentChildren = useMemo(() => onlyElements(children), [children]);\n    /**\n     * Track the keys of the currently rendered children. This is used to\n     * determine which children are exiting.\n     */\n    const presentKeys = propagate && !isParentPresent ? [] : presentChildren.map(getChildKey);\n    /**\n     * If `initial={false}` we only want to pass this to components in the first render.\n     */\n    const isInitialRender = useRef(true);\n    /**\n     * A ref containing the currently present children. When all exit animations\n     * are complete, we use this to re-render the component with the latest children\n     * *committed* rather than the latest children *rendered*.\n     */\n    const pendingPresentChildren = useRef(presentChildren);\n    /**\n     * Track which exiting children have finished animating out.\n     */\n    const exitComplete = useConstant(() => new Map());\n    /**\n     * Track which components are currently processing exit to prevent duplicate processing.\n     */\n    const exitingComponents = useRef(new Set());\n    /**\n     * Save children to render as React state. To ensure this component is concurrent-safe,\n     * we check for exiting children via an effect.\n     */\n    const [diffedChildren, setDiffedChildren] = useState(presentChildren);\n    const [renderedChildren, setRenderedChildren] = useState(presentChildren);\n    useIsomorphicLayoutEffect(() => {\n        isInitialRender.current = false;\n        pendingPresentChildren.current = presentChildren;\n        /**\n         * Update complete status of exiting children.\n         */\n        for (let i = 0; i < renderedChildren.length; i++) {\n            const key = getChildKey(renderedChildren[i]);\n            if (!presentKeys.includes(key)) {\n                if (exitComplete.get(key) !== true) {\n                    exitComplete.set(key, false);\n                }\n            }\n            else {\n                exitComplete.delete(key);\n                exitingComponents.current.delete(key);\n            }\n        }\n    }, [renderedChildren, presentKeys.length, presentKeys.join(\"-\")]);\n    const exitingChildren = [];\n    if (presentChildren !== diffedChildren) {\n        let nextChildren = [...presentChildren];\n        /**\n         * Loop through all the currently rendered components and decide which\n         * are exiting.\n         */\n        for (let i = 0; i < renderedChildren.length; i++) {\n            const child = renderedChildren[i];\n            const key = getChildKey(child);\n            if (!presentKeys.includes(key)) {\n                nextChildren.splice(i, 0, child);\n                exitingChildren.push(child);\n            }\n        }\n        /**\n         * If we're in \"wait\" mode, and we have exiting children, we want to\n         * only render these until they've all exited.\n         */\n        if (mode === \"wait\" && exitingChildren.length) {\n            nextChildren = exitingChildren;\n        }\n        setRenderedChildren(onlyElements(nextChildren));\n        setDiffedChildren(presentChildren);\n        /**\n         * Early return to ensure once we've set state with the latest diffed\n         * children, we can immediately re-render.\n         */\n        return null;\n    }\n    if (process.env.NODE_ENV !== \"production\" &&\n        mode === \"wait\" &&\n        renderedChildren.length > 1) {\n        console.warn(`You're attempting to animate multiple children within AnimatePresence, but its mode is set to \"wait\". This will lead to odd visual behaviour.`);\n    }\n    /**\n     * If we've been provided a forceRender function by the LayoutGroupContext,\n     * we can use it to force a re-render amongst all surrounding components once\n     * all components have finished animating out.\n     */\n    const { forceRender } = useContext(LayoutGroupContext);\n    return (jsx(Fragment, { children: renderedChildren.map((child) => {\n            const key = getChildKey(child);\n            const isPresent = propagate && !isParentPresent\n                ? false\n                : presentChildren === renderedChildren ||\n                    presentKeys.includes(key);\n            const onExit = () => {\n                if (exitingComponents.current.has(key)) {\n                    return;\n                }\n                exitingComponents.current.add(key);\n                if (exitComplete.has(key)) {\n                    exitComplete.set(key, true);\n                }\n                else {\n                    return;\n                }\n                let isEveryExitComplete = true;\n                exitComplete.forEach((isExitComplete) => {\n                    if (!isExitComplete)\n                        isEveryExitComplete = false;\n                });\n                if (isEveryExitComplete) {\n                    forceRender?.();\n                    setRenderedChildren(pendingPresentChildren.current);\n                    propagate && safeToRemove?.();\n                    onExitComplete && onExitComplete();\n                }\n            };\n            return (jsx(PresenceChild, { isPresent: isPresent, initial: !isInitialRender.current || initial\n                    ? undefined\n                    : false, custom: custom, presenceAffectsLayout: presenceAffectsLayout, mode: mode, root: root, onExitComplete: isPresent ? undefined : onExit, anchorX: anchorX, anchorY: anchorY, children: child }, key));\n        }) }));\n};\n\nexport { AnimatePresence };\n//# sourceMappingURL=index.mjs.map\n","import { TrashIcon } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Button } from \"zudoku/ui/Button.js\";\nimport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"zudoku/ui/Dialog.js\";\nimport { Secret } from \"zudoku/ui/Secret.js\";\nimport { cn } from \"../../../util/cn.js\";\nimport type { ApiKey } from \"../index.js\";\n\nexport const RevealApiKey = ({\n  apiKey,\n  onDeleteKey,\n  className,\n}: {\n  apiKey: ApiKey;\n  onDeleteKey: () => void;\n  className?: string;\n}) => {\n  const [revealed, setRevealed] = useState(false);\n\n  const { key, createdOn, expiresOn } = apiKey;\n  const isExpired = expiresOn && new Date(expiresOn) < new Date();\n  const daysUntilExpiry = expiresOn\n    ? Math.ceil(\n        (new Date(expiresOn).getTime() - Date.now()) / (1000 * 60 * 60 * 24),\n      )\n    : Infinity;\n  const expiresSoon = daysUntilExpiry <= 7 && !isExpired;\n\n  return (\n    <div className={cn(\"grid col-span-full grid-cols-subgrid p-6\", className)}>\n      <div className=\"flex flex-col gap-1\">\n        <Secret\n          className=\"max-w-fit w-full\"\n          secret={key}\n          status={isExpired ? \"expired\" : expiresSoon ? \"expiring\" : \"active\"}\n          revealed={revealed}\n          onReveal={setRevealed}\n        />\n        <div className=\"flex gap-1 mt-0.5 text-nowrap\">\n          {createdOn && (\n            <span className=\"text-xs text-muted-foreground\">\n              Created {getTimeAgo(createdOn)}.\n            </span>\n          )}{\" \"}\n          {expiresOn && expiresSoon && (\n            <span className=\"text-xs text-primary\">\n              Expires in {daysUntilExpiry}{\" \"}\n              {daysUntilExpiry === 1 ? \"day\" : \"days\"}.\n            </span>\n          )}\n          {expiresOn && isExpired && (\n            <span className=\"text-xs text-primary\">\n              Expired{\" \"}\n              {daysUntilExpiry === 0\n                ? \"today.\"\n                : `${daysUntilExpiry * -1} days ago.`}\n            </span>\n          )}\n        </div>\n      </div>\n      <div className=\"flex justify-end\">\n        {expiresOn && onDeleteKey && (\n          <Dialog>\n            <DialogTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\">\n                <TrashIcon size={16} />\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Delete API Key</DialogTitle>\n                <DialogDescription>\n                  Are you sure you want to delete this API key?\n                </DialogDescription>\n              </DialogHeader>\n              <DialogFooter>\n                <DialogClose asChild>\n                  <Button variant=\"outline\">Cancel</Button>\n                </DialogClose>\n                <DialogClose asChild>\n                  <Button\n                    onClick={() => {\n                      onDeleteKey();\n                    }}\n                  >\n                    Delete\n                  </Button>\n                </DialogClose>\n              </DialogFooter>\n            </DialogContent>\n          </Dialog>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst getTimeAgo = (date: string) => {\n  const now = new Date();\n  const created = new Date(date);\n  const diffInSeconds = Math.floor((now.getTime() - created.getTime()) / 1000);\n\n  const rtf = new Intl.RelativeTimeFormat(\"en\", { numeric: \"auto\" });\n\n  if (diffInSeconds < 60) return rtf.format(-diffInSeconds, \"second\");\n  if (diffInSeconds < 3600)\n    return rtf.format(-Math.floor(diffInSeconds / 60), \"minute\");\n  if (diffInSeconds < 86400)\n    return rtf.format(-Math.floor(diffInSeconds / 3600), \"hour\");\n  if (diffInSeconds < 2592000)\n    return rtf.format(-Math.floor(diffInSeconds / 86400), \"day\");\n  if (diffInSeconds < 31536000)\n    return rtf.format(-Math.floor(diffInSeconds / 2592000), \"month\");\n  return rtf.format(-Math.floor(diffInSeconds / 31536000), \"year\");\n};\n","import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  CheckIcon,\n  CircleSlashIcon,\n  PencilLineIcon,\n  RefreshCwIcon,\n  XIcon,\n} from \"lucide-react\";\nimport { AnimatePresence } from \"motion/react\";\nimport { useState } from \"react\";\nimport { Alert, AlertTitle } from \"zudoku/ui/Alert.js\";\nimport { Button } from \"zudoku/ui/Button.js\";\nimport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"zudoku/ui/Dialog.js\";\nimport {\n  Frame,\n  FrameDescription,\n  FrameHeader,\n  FramePanel,\n  FrameTitle,\n} from \"zudoku/ui/Frame.js\";\nimport { Input } from \"zudoku/ui/Input.js\";\nimport { useZudoku } from \"../../../components/context/ZudokuContext.js\";\nimport type { ZudokuContext } from \"../../../core/ZudokuContext.js\";\nimport { cn } from \"../../../util/cn.js\";\nimport type { ApiConsumer } from \"../index.js\";\nimport { RevealApiKey } from \"./RevealApiKey.js\";\n\nconst ApiKeyItem = ({\n  consumer,\n  onUpdate,\n  onRollKey,\n  onDeleteKey,\n}: {\n  consumer: ApiConsumer;\n  onUpdate?: (\n    data: { label: string; id: string },\n    context: ZudokuContext,\n  ) => Promise<void>;\n  onRollKey?: (consumerId: string, context: ZudokuContext) => Promise<void>;\n  onDeleteKey?: (\n    consumerId: string,\n    keyId: string,\n    context: ZudokuContext,\n  ) => Promise<void>;\n}) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editingLabel, setEditingLabel] = useState(consumer.label);\n  const queryClient = useQueryClient();\n  const context = useZudoku();\n\n  const rollKeyMutation = useMutation({\n    mutationFn: async (id: string) => {\n      if (!onRollKey) {\n        throw new Error(\"rollKey not implemented\");\n      }\n\n      return await onRollKey?.(id, context);\n    },\n    onSuccess: () =>\n      void queryClient.invalidateQueries({ queryKey: [\"api-keys\"] }),\n  });\n\n  const deleteKeyMutation = useMutation({\n    mutationFn: ({\n      consumerId,\n      keyId,\n    }: {\n      consumerId: string;\n      keyId: string;\n    }) => {\n      if (!onDeleteKey) {\n        throw new Error(\"deleteKey not implemented\");\n      }\n\n      return onDeleteKey(consumerId, keyId, context);\n    },\n    onMutate: async ({ consumerId, keyId }) => {\n      await queryClient.cancelQueries({ queryKey: [\"api-keys\"] });\n      const previousData = queryClient.getQueryData<ApiConsumer[]>([\n        \"api-keys\",\n      ]);\n      queryClient.setQueryData<ApiConsumer[]>([\"api-keys\"], (old) => {\n        if (!old) {\n          return old;\n        }\n\n        return old.map((consumer) => {\n          if (consumer.id === consumerId) {\n            return {\n              ...consumer,\n              apiKeys: consumer.apiKeys.filter((key) => key.id !== keyId),\n            };\n          }\n          return consumer;\n        });\n      });\n\n      return { previousData };\n    },\n    onError: (_err, _variables, context) => {\n      if (context?.previousData) {\n        queryClient.setQueryData([\"api-keys\"], context.previousData);\n      }\n    },\n    onSuccess: () => {\n      void queryClient.invalidateQueries({ queryKey: [\"api-keys\"] });\n    },\n  });\n\n  const updateConsumerMutation = useMutation({\n    mutationFn: ({\n      consumerId,\n      label,\n    }: {\n      consumerId: string;\n      label: string;\n    }) => {\n      if (!onUpdate) {\n        throw new Error(\"updateConsumer not implemented\");\n      }\n\n      return onUpdate({ id: consumerId, label }, context);\n    },\n    onMutate: async ({ consumerId, label }) => {\n      await queryClient.cancelQueries({ queryKey: [\"api-keys\"] });\n\n      const previousData = queryClient.getQueryData([\"api-keys\"]);\n      queryClient.setQueryData<ApiConsumer[]>([\"api-keys\"], (old) => {\n        if (!old) {\n          return old;\n        }\n\n        return old.map((consumer) => {\n          if (consumer.id === consumerId) {\n            return {\n              ...consumer,\n              label,\n            };\n          }\n          return consumer;\n        });\n      });\n\n      return { previousData };\n    },\n    onError: (_err, _variables, context) => {\n      if (context?.previousData) {\n        queryClient.setQueryData([\"api-keys\"], context.previousData);\n      }\n    },\n    onSuccess: () => {\n      void queryClient.invalidateQueries({ queryKey: [\"api-keys\"] });\n    },\n  });\n\n  const handleStartEdit = () => {\n    setIsEditing(true);\n    setEditingLabel(consumer.label);\n  };\n\n  const handleSaveEdit = () => {\n    if (editingLabel.trim()) {\n      updateConsumerMutation.mutate({\n        label: editingLabel.trim(),\n        consumerId: consumer.id,\n      });\n    }\n    setIsEditing(false);\n  };\n\n  return (\n    <>\n      {rollKeyMutation.isError && (\n        <Alert variant=\"destructive\" className=\"mb-4\">\n          <CircleSlashIcon size={16} />\n          <AlertTitle>{rollKeyMutation.error.message}</AlertTitle>\n        </Alert>\n      )}\n      {updateConsumerMutation.isError && (\n        <Alert variant=\"destructive\" className=\"mb-4\">\n          <CircleSlashIcon size={16} />\n          <AlertTitle>{updateConsumerMutation.error.message}</AlertTitle>\n        </Alert>\n      )}\n      {deleteKeyMutation.isError && (\n        <Alert variant=\"destructive\" className=\"mb-4\">\n          <CircleSlashIcon size={16} />\n          <AlertTitle>{deleteKeyMutation.error.message}</AlertTitle>\n        </Alert>\n      )}\n      <Frame\n        className=\"grid grid-cols-subgrid col-span-full items-center mb-4 group\"\n        key={consumer.id}\n      >\n        <FrameHeader className=\"col-span-full flex-row items-start justify-between gap-4\">\n          <div className=\"flex flex-col gap-1\">\n            {isEditing ? (\n              <div className=\"flex items-center gap-2\">\n                <Input\n                  maxLength={32}\n                  value={editingLabel}\n                  onChange={(e) => setEditingLabel(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\") {\n                      handleSaveEdit();\n                    } else if (e.key === \"Escape\") {\n                      setIsEditing(false);\n                    }\n                  }}\n                  autoFocus\n                />\n                <div className=\"flex items-center\">\n                  <Button\n                    size=\"icon\"\n                    variant=\"ghost\"\n                    onClick={handleSaveEdit}\n                    disabled={!editingLabel.trim()}\n                  >\n                    <CheckIcon size={16} />\n                  </Button>\n                  <Button\n                    size=\"icon\"\n                    variant=\"ghost\"\n                    onClick={() => setIsEditing(false)}\n                  >\n                    <XIcon size={16} />\n                  </Button>\n                </div>\n              </div>\n            ) : (\n              <FrameTitle>{consumer.label}</FrameTitle>\n            )}\n            <FrameDescription>\n              {consumer.createdOn && (\n                <div>\n                  Created on {new Date(consumer.createdOn).toLocaleDateString()}\n                </div>\n              )}\n              {consumer.expiresOn && (\n                <div>\n                  Expires on {new Date(consumer.expiresOn).toLocaleDateString()}\n                </div>\n              )}\n            </FrameDescription>\n          </div>\n\n          <div className=\"flex gap-1\">\n            {onUpdate && (\n              <Button\n                variant=\"ghost\"\n                onClick={handleStartEdit}\n                className={cn(\n                  \"flex gap-2\",\n                  isEditing && \"opacity-0! pointer-events-none\",\n                )}\n                disabled={isEditing}\n              >\n                <PencilLineIcon size={16} />\n                <span className=\"hidden md:block\">Edit label</span>\n              </Button>\n            )}\n            {onRollKey && (\n              <Dialog>\n                <DialogTrigger asChild>\n                  <Button\n                    title=\"Roll this key\"\n                    variant=\"ghost\"\n                    disabled={rollKeyMutation.isPending}\n                    className=\"flex items-center gap-2\"\n                  >\n                    <RefreshCwIcon\n                      size={16}\n                      className={\n                        rollKeyMutation.isPending ? \"animate-spin\" : undefined\n                      }\n                    />\n                    <span className=\"hidden md:block\">Roll key</span>\n                  </Button>\n                </DialogTrigger>\n                <DialogContent>\n                  <DialogHeader>\n                    <DialogTitle>Roll API Key</DialogTitle>\n                    <DialogDescription>\n                      Are you sure you want to roll this API key?\n                    </DialogDescription>\n                  </DialogHeader>\n                  <DialogFooter>\n                    <DialogClose asChild>\n                      <Button variant=\"outline\">Cancel</Button>\n                    </DialogClose>\n                    <DialogClose asChild>\n                      <Button\n                        onClick={() => {\n                          rollKeyMutation.mutate(consumer.id);\n                        }}\n                      >\n                        Roll Key\n                      </Button>\n                    </DialogClose>\n                  </DialogFooter>\n                </DialogContent>\n              </Dialog>\n            )}\n          </div>\n        </FrameHeader>\n        <FramePanel className=\"p-0 grid grid-cols-subgrid col-span-full divide-y divide-border\">\n          <AnimatePresence>\n            {consumer.apiKeys.map((apiKey) => (\n              <RevealApiKey\n                key={apiKey.id}\n                apiKey={apiKey}\n                onDeleteKey={() => {\n                  deleteKeyMutation.mutate({\n                    consumerId: consumer.id,\n                    keyId: apiKey.id,\n                  });\n                }}\n                className={\n                  deleteKeyMutation.variables?.keyId === apiKey.id &&\n                  deleteKeyMutation.isPending\n                    ? \"opacity-10!\"\n                    : undefined\n                }\n              />\n            ))}\n          </AnimatePresence>\n        </FramePanel>\n      </Frame>\n    </>\n  );\n};\n\nexport default ApiKeyItem;\n","import { useSuspenseQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { useZudoku } from \"../../../components/context/ZudokuContext.js\";\nimport { cn } from \"../../../util/cn.js\";\nimport { ZudokuError } from \"../../../util/invariant.js\";\nimport { CreateApiKeyDialog } from \"../CreateApiKeyDialog.js\";\nimport type { ApiKeyService } from \"../index.js\";\nimport ApiKeyItem from \"./ApiKeyItem.js\";\n\nexport const ApiKeyList = ({ service }: { service: ApiKeyService }) => {\n  const context = useZudoku();\n\n  const { data } = useSuspenseQuery({\n    queryFn: async () => {\n      try {\n        return await service.getConsumers(context);\n      } catch (error) {\n        if (error instanceof ZudokuError) {\n          throw error;\n        }\n        throw new ZudokuError(\"Cannot get API keys\", {\n          cause: error,\n          title: \"Error getting API keys\",\n          developerHint:\n            \"Check the response of the API request for more information.\",\n        });\n      }\n    },\n    queryKey: [\"api-keys\"],\n    retry: false,\n  });\n\n  const [isCreateApiKeyOpen, setIsCreateApiKeyOpen] = useState(false);\n\n  return (\n    <div className=\"mt-8\">\n      {data.length === 0 ? (\n        <div className=\"flex col-span-full flex-col justify-center gap-4 items-center p-8 border rounded-sm bg-muted/30 text-muted-foreground\">\n          <p className=\"text-center\">\n            You have no API keys yet.\n            <br />\n            {service.createKey && \"Get started and create your first key.\"}\n          </p>\n          {service.createKey && (\n            <CreateApiKeyDialog\n              service={service}\n              isOpen={isCreateApiKeyOpen}\n              onOpenChange={setIsCreateApiKeyOpen}\n            />\n          )}\n        </div>\n      ) : (\n        <ul className={cn(\"grid grid-cols-[1fr_min-content] col-span-6\")}>\n          {data.map((consumer) => (\n            <ApiKeyItem\n              key={consumer.id}\n              consumer={consumer}\n              onUpdate={service.updateConsumer}\n              onRollKey={service.rollKey}\n              onDeleteKey={service.deleteKey}\n            />\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\n","import { useState } from \"react\";\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport { Button } from \"zudoku/components\";\nimport { useAuth } from \"zudoku/hooks\";\nimport {\n  Item,\n  ItemActions,\n  ItemContent,\n  ItemDescription,\n  ItemTitle,\n} from \"zudoku/ui/Item.js\";\nimport { useVerifiedEmail } from \"../../authentication/hook.js\";\nimport { Slot } from \"../../components/Slot.js\";\nimport { ErrorMessage } from \"../../errors/ErrorMessage.js\";\nimport { CreateApiKeyDialog } from \"./CreateApiKeyDialog.js\";\nimport type { ApiKeyService } from \"./index.js\";\nimport { ApiKeyList } from \"./settings/ApiKeyList.js\";\n\nexport const SettingsApiKeys = ({ service }: { service: ApiKeyService }) => {\n  const [isCreateApiKeyOpen, setIsCreateApiKeyOpen] = useState(false);\n  const auth = useAuth();\n  const { supportsEmailVerification, requestEmailVerification, refresh } =\n    useVerifiedEmail();\n\n  return (\n    <div className=\"max-w-3xl h-full pt-(--padding-content-top) pb-(--padding-content-bottom)\">\n      <Slot.Target name=\"api-keys-list-page\" />\n\n      <div className=\"flex justify-between pb-3\">\n        <h1 className=\"font-medium text-2xl\">API Keys</h1>\n\n        {service.createKey && (\n          <CreateApiKeyDialog\n            service={service}\n            isOpen={isCreateApiKeyOpen}\n            onOpenChange={setIsCreateApiKeyOpen}\n          />\n        )}\n      </div>\n      <p>Create, manage, and monitor your API keys</p>\n\n      <Slot.Target name=\"api-keys-list-page-before-keys\" />\n      {auth.profile?.emailVerified === false ? (\n        <Item variant=\"outline\" className=\"mt-4\">\n          <ItemContent>\n            <ItemTitle>Verified email required</ItemTitle>\n            <ItemDescription>\n              You need to verify your email to access API keys.\n              <Button onClick={refresh}>Refresh</Button>\n            </ItemDescription>\n          </ItemContent>\n\n          {supportsEmailVerification && (\n            <ItemActions>\n              <Button onClick={() => requestEmailVerification()}>\n                Request verification\n              </Button>\n            </ItemActions>\n          )}\n        </Item>\n      ) : (\n        <ErrorBoundary\n          fallbackRender={({ error }) => <ErrorMessage error={error} />}\n        >\n          <ApiKeyList service={service} />\n        </ErrorBoundary>\n      )}\n    </div>\n  );\n};\n","import { KeyRoundIcon } from \"lucide-react\";\nimport type { RouteObject } from \"react-router\";\nimport type { ApiKeysOptions } from \"../../../config/validators/validate.js\";\nimport type { UseAuthReturn } from \"../../authentication/hook.js\";\nimport type {\n  ApiIdentityPlugin,\n  ProfileMenuPlugin,\n  ZudokuPlugin,\n} from \"../../core/plugins.js\";\nimport type { ZudokuContext } from \"../../core/ZudokuContext.js\";\nimport invariant from \"../../util/invariant.js\";\nimport { SettingsApiKeys } from \"./SettingsApiKeys.js\";\n\nconst DEFAULT_API_KEY_ENDPOINT = \"https://api.zuploedge.com/v2/client\";\n\nexport type ApiKeyService = {\n  getConsumers: (context: ZudokuContext) => Promise<ApiConsumer[]>;\n  rollKey?: (consumerId: string, context: ZudokuContext) => Promise<void>;\n  deleteKey?: (\n    consumerId: string,\n    keyId: string,\n    context: ZudokuContext,\n  ) => Promise<void>;\n  updateConsumer?: (\n    consumer: { id: string; label?: string },\n    context: ZudokuContext,\n  ) => Promise<void>;\n  getUsage?: (apiKeys: string[], context: ZudokuContext) => Promise<void>;\n  createKey?: ({\n    apiKey,\n    context,\n    auth,\n  }: {\n    apiKey: { description: string; expiresOn?: string };\n    context: ZudokuContext;\n    auth: UseAuthReturn;\n  }) => Promise<void>;\n};\n\nexport type ApiKeyPluginOptions = ApiKeyService | DefaultApiKeyServiceOptions;\n\ntype DefaultApiKeyServiceOptions = {\n  deploymentName?: string;\n} & Partial<ApiKeyService>;\n\nexport interface ApiKey {\n  id: string;\n  description?: string;\n  createdOn?: string;\n  updatedOn?: string;\n  expiresOn?: string;\n  key: string;\n}\n\nexport interface ApiConsumer {\n  id: string;\n  label: string;\n  apiKeys: ApiKey[];\n  description?: string;\n  createdOn?: string;\n  updatedOn?: string;\n  expiresOn?: string;\n  key?: ApiKey;\n}\n\nconst parseJsonSafe = async (response: Response) => {\n  try {\n    return await response.json();\n  } catch {\n    return;\n  }\n};\n\nconst throwIfProblemJson = async (response: Response) => {\n  const contentType = response.headers.get(\"content-type\");\n  if (!response.ok && contentType?.includes(\"application/problem+json\")) {\n    const data = await parseJsonSafe(response);\n    if (data.type && data.title) {\n      throw new Error(data.detail ?? data.title);\n    }\n  }\n};\n\nconst developerHintOptions = {\n  developerHint:\n    \"This project is not linked to a Zuplo deployment. Run `zuplo link` to get started with API Keys.\",\n  title: \"Not linked to a Zuplo deployment\",\n};\n\nconst createZuploService = ({\n  deploymentName,\n  ...options\n}: DefaultApiKeyServiceOptions): ApiKeyService => {\n  return {\n    deleteKey: async (consumerId, keyId, context) => {\n      invariant(deploymentName, \"Cannot delete API key.\", developerHintOptions);\n      const request = new Request(\n        DEFAULT_API_KEY_ENDPOINT +\n          `/${deploymentName}/consumers/${consumerId}/keys/${keyId}`,\n        {\n          method: \"DELETE\",\n        },\n      );\n      const response = await fetch(await context.signRequest(request));\n      await throwIfProblemJson(response);\n      invariant(response.ok, \"Failed to delete API key\");\n    },\n    updateConsumer: async (consumer, context) => {\n      invariant(\n        deploymentName,\n        \"Cannot update API key description.\",\n        developerHintOptions,\n      );\n      const response = await fetch(\n        await context.signRequest(\n          new Request(\n            `${DEFAULT_API_KEY_ENDPOINT}/${deploymentName}/consumers/${consumer.id}`,\n            {\n              method: \"PATCH\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n              body: JSON.stringify({\n                label: consumer.label,\n              }),\n            },\n          ),\n        ),\n      );\n      await throwIfProblemJson(response);\n      invariant(response.ok, \"Failed to update API key description\");\n    },\n    rollKey: async (consumerId, context) => {\n      invariant(deploymentName, \"Cannot roll API key.\", developerHintOptions);\n      const response = await fetch(\n        await context.signRequest(\n          new Request(\n            `${DEFAULT_API_KEY_ENDPOINT}/${deploymentName}/consumers/${consumerId}/roll-key`,\n            {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n              body: JSON.stringify({}),\n            },\n          ),\n        ),\n      );\n      await throwIfProblemJson(response);\n      invariant(response.ok, \"Failed to roll API key\");\n    },\n    getConsumers: async (context) => {\n      invariant(deploymentName, \"Cannot get API keys.\", developerHintOptions);\n      const request = new Request(\n        `${DEFAULT_API_KEY_ENDPOINT}/${deploymentName}/consumers`,\n      );\n      await context.signRequest(request);\n\n      const keys = await fetch(request);\n      await throwIfProblemJson(keys);\n      invariant(keys.ok, \"Failed to fetch API keys\");\n\n      const data = (await keys.json()) as {\n        data: [\n          {\n            id: string;\n            label?: string;\n            subject?: string;\n            createdOn?: string;\n            updatedOn?: string;\n            expiresOn?: string;\n            apiKeys: {\n              data: ApiKey[];\n            };\n          },\n        ];\n      };\n\n      return data.data.map((consumer) => ({\n        id: consumer.id,\n        createdOn: consumer.createdOn,\n        updatedOn: consumer.updatedOn,\n        expiresOn: consumer.expiresOn,\n        label: consumer.label || consumer.subject || \"API Key\",\n        apiKeys: consumer.apiKeys.data,\n        key: consumer.apiKeys.data.at(0),\n      }));\n    },\n    ...options,\n  };\n};\n\nexport const createApiKeyService = <T extends ApiKeyService>(service: T): T =>\n  service;\n\ntype InternalApiKeyPluginOptions = {\n  // The name of the Zuplo deployment\n  deploymentName?: string;\n  // Indicates that the plugin is running in Zuplo \"mode\"\n  isZuplo?: boolean;\n};\n\nexport const apiKeyPlugin = ({\n  deploymentName,\n  isZuplo,\n  ...options\n}: Omit<ApiKeysOptions, \"enabled\"> &\n  InternalApiKeyPluginOptions): ZudokuPlugin &\n  ApiIdentityPlugin &\n  ProfileMenuPlugin => {\n  if (isZuplo && !deploymentName) {\n    // biome-ignore lint/suspicious/noConsole: Important warning\n    console.warn(\n      \"This project is not linked to a Zuplo deployment. Run `zuplo link` to get started.\",\n    );\n  }\n\n  const service = isZuplo\n    ? createZuploService({ deploymentName, ...options })\n    : options;\n\n  if (!service.getConsumers) {\n    throw new Error(\"getConsumers is required when using the apiKeyPlugin\");\n  }\n\n  const verifiedService: ApiKeyService = {\n    ...service,\n    getConsumers: service.getConsumers,\n  };\n\n  return {\n    getProfileMenuItems: () => [\n      {\n        label: \"API Keys\",\n        path: \"/settings/api-keys\",\n        category: \"middle\",\n        icon: KeyRoundIcon,\n      },\n    ],\n\n    getIdentities: async (context) => {\n      try {\n        const consumers = await verifiedService.getConsumers(context);\n\n        return consumers.map((consumer) => ({\n          authorizeRequest: (request) => {\n            request.headers.set(\n              \"Authorization\",\n              `Bearer ${consumer.apiKeys.at(0)?.key}`,\n            );\n            return request;\n          },\n          id: consumer.id,\n          label: consumer.label,\n        }));\n      } catch {\n        return [];\n      }\n    },\n\n    getRoutes: (): RouteObject[] => {\n      return [\n        {\n          path: \"/settings/api-keys\",\n          element: <SettingsApiKeys service={verifiedService} />,\n        },\n      ];\n    },\n\n    getProtectedRoutes: () => {\n      return [\"/settings/api-keys\"];\n    },\n  };\n};\n"],"names":["ErrorMessage","error","message","showDeveloperHints","hint","ZudokuError","title","stack","cause","stringError","jsxs","Fragment","Alert","jsx","AlertTitle","AlertDescription","DeveloperHint","SyntaxHighlight","CreateApiKey","service","onOpenChange","context","useZudoku","queryClient","useQueryClient","navigate","useNavigate","form","useForm","auth","useAuth","createKeyMutation","useMutation","description","expiresOn","expiresOnDate","addDaysToDate","data","Input","Select","value","SelectTrigger","SelectValue","SelectContent","SelectGroup","option","SelectItem","DialogFooter","DialogClose","Button","ActionButton","days","date","CreateApiKeyDialog","isOpen","trigger","buttonVariant","defaultTrigger","Dialog","DialogTrigger","DialogContent","DialogHeader","DialogTitle","LayoutGroupContext","createContext","useConstant","init","ref","useRef","isBrowser","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","PresenceContext","isObject","isHTMLElement","element","MotionConfigContext","p","setRef","composeRefs","refs","node","hasCleanup","cleanups","cleanup","i","useComposedRefs","React","PopChildMeasure","prevProps","parent","parentWidth","parentHeight","size","PopChild","children","isPresent","anchorX","anchorY","root","id","useId","nonce","useContext","childRef","composedRef","useInsertionEffect","width","height","top","left","right","bottom","x","y","style","PresenceChild","initial","onExitComplete","custom","presenceAffectsLayout","mode","presenceChildren","newChildrenMap","isReusedContext","useMemo","childId","isComplete","_","key","usePresence","subscribe","register","safeToRemove","useCallback","getChildKey","child","onlyElements","filtered","Children","isValidElement","AnimatePresence","propagate","isParentPresent","presentChildren","presentKeys","isInitialRender","pendingPresentChildren","exitComplete","exitingComponents","diffedChildren","setDiffedChildren","useState","renderedChildren","setRenderedChildren","exitingChildren","nextChildren","forceRender","onExit","isEveryExitComplete","isExitComplete","RevealApiKey","apiKey","onDeleteKey","className","revealed","setRevealed","createdOn","isExpired","daysUntilExpiry","expiresSoon","cn","Secret","getTimeAgo","TrashIcon","DialogDescription","now","created","diffInSeconds","rtf","ApiKeyItem","consumer","onUpdate","onRollKey","isEditing","setIsEditing","editingLabel","setEditingLabel","rollKeyMutation","deleteKeyMutation","consumerId","keyId","previousData","old","_err","_variables","updateConsumerMutation","label","handleStartEdit","handleSaveEdit","CircleSlashIcon","Frame","FrameHeader","e","CheckIcon","XIcon","FrameTitle","FrameDescription","PencilLineIcon","RefreshCwIcon","FramePanel","ApiKeyList","useSuspenseQuery","isCreateApiKeyOpen","setIsCreateApiKeyOpen","SettingsApiKeys","supportsEmailVerification","requestEmailVerification","refresh","useVerifiedEmail","Slot","Item","ItemContent","ItemTitle","ItemDescription","ItemActions","ErrorBoundary","DEFAULT_API_KEY_ENDPOINT","parseJsonSafe","response","throwIfProblemJson","contentType","developerHintOptions","createZuploService","deploymentName","options","invariant","request","keys","createApiKeyService","apiKeyPlugin","isZuplo","verifiedService","KeyRoundIcon"],"mappings":"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","x_google_ignoreList":[3,4,5,6,7,8,9,10,11,12,13,14,15,16]}